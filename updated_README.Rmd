---
output: github_document
---

```{r}
library(covr)
```



```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# bis620.2023



<!-- badges: start -->
[![R-CMD-check](https://github.com/zihanwang00/bis620.2023/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/zihanwang00/bis620.2023/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of bis620.2023 is to create a package that allows for the visualization and a platform that facilitates viewers experience with interacting with large and copious amounts of data. It serves to create an interface where viewers can view the distinct features and attributes of the data, specifically comparing to treatment and condition. 
We apply some of the following operations: creating a world map of trials, creating a condition keyword search, creating an intervention and condition mapping, creating a pie chart for outcomes, having an ID count for individual countries, and finally creating a picture of a word cloud. All of these serve to facilitate the process of processing and visualizing the data more easily as well as making it more interpretable for the viewer to see as well. 


## Installation

You can install the development version of bis620.2023 from [GitHub](https://github.com/) with:


```{r}
install.packages("devtools")
devtools::install_github("zihanwang00/bis620.2023")
```




## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(bis620.2023)
accel |> 
  head(100) |> 
  plot_accel()
```
```{r}
library(bis620.2023)


con = dbConnect(
  duckdb(
    file.path("..", "..", "midterms", "data-science-software-systems-main 2", "2023-09-27", "ctgov.duckdb"), 
    read_only = TRUE
  )
)

if (length(dbListTables(con)) == 0) {
  stop("Problem reading from connection.")
}
studies = tbl(con, "studies")
sponsors = tbl(con, "sponsors")
conditions = tbl(con, "conditions")
countries = tbl(con, "countries")
outcomes = tbl(con, "outcomes")
interventions = tbl(con, "interventions")
interventions_local=interventions |>
  collect()

```

```{r}
word_cloud <- function(study, condition) {
  num_con <- study %>%
    inner_join(condition, by = "nct_id")
  
  corpus <- Corpus(VectorSource(num_con$name))
  corpus <- tm_map(corpus, content_transformer(tolower))
  corpus <- tm_map(corpus, removePunctuation)
  corpus <- tm_map(corpus, removeNumbers)
  corpus <- tm_map(corpus, removeWords, stopwords("en"))
  corpus <- tm_map(corpus, stripWhitespace)
  
  # Extract terms from the corpus
  terms <- unlist(strsplit(as.character(corpus), " "))
  
  # Create a word cloud
  wordcloud(words = terms, scale = 3, max.words = 100, random.order = FALSE, colors = brewer.pal(8, "Dark2"))
}

word_cloud(studies, conditions)

```



```{r}
library(report)
report()
```
